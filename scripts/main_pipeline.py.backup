import os
import sys

def process_project(project_name, base_dir):
    """
    ÊåáÂÆö„Åï„Çå„Åü„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´ÂØæ„Åô„Çã„É°„Ç§„É≥„ÅÆÂá¶ÁêÜ„ÇíÂÆüË°å„Åó„Åæ„Åô„ÄÇ
    („Åì„ÅÆÈñ¢Êï∞„ÅÆ‰∏≠Ë∫´„ÅØ„ÅÇ„Å™„Åü„ÅÆÊó¢Â≠ò„ÅÆ„Ç≥„Éº„Éâ„ÇíÊÉ≥ÂÆö„Åó„Å¶„ÅÑ„Åæ„Åô)
    """
    print("==================================================")
    print(f"‚ñ∂Ô∏è „Éó„É≠„Ç∏„Çß„ÇØ„ÉàÈñãÂßã: '{project_name}'")
    print("==================================================")
    
    # „Åì„Åì„Å´„ÄÅÂêÑ„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÔºà‰æã: „ÅØ„Åæ„Åü„Çç„ÅÜÔºâ„Å´ÂØæ„Åô„Çã
    # p1_claude_generate_settings.py „ÅÆÂÆüË°å„Å™„Å©„ÅÆÂá¶ÁêÜ„ÅåÁ∂ö„Åè„Å®ÊÉ≥ÂÆö„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ
    # „Åì„ÅÆ„Çµ„É≥„Éó„É´„Åß„ÅØÊàêÂäü„Åó„Åü„Å®‰ªÆÂÆö„Åó„Å¶„É°„ÉÉ„Çª„Éº„Ç∏„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ
    
    print(f"‚úÖ „Éó„É≠„Ç∏„Çß„ÇØ„Éà '{project_name}' „ÅÆÂá¶ÁêÜÂÆå‰∫Ü„ÄÇ")


def process_batch():
    """
    „Éê„ÉÉ„ÉÅÂá¶ÁêÜ„ÇíÂÆüË°å„Åó„Åæ„Åô„ÄÇ
    'scripts'„Éï„Ç©„É´„ÉÄÂÜÖ„Å´„ÅÇ„Çã„Äå„Éï„Ç©„É´„ÉÄ„Äç„ÅÆ„Åø„Çí„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å®„Åó„Å¶Âá¶ÁêÜ„Åó„Åæ„Åô„ÄÇ
    """
    # Dockerfile„ÅÆWORKDIR„ÅØ /app „Å™„ÅÆ„Åß„ÄÅ
    # ÂÆüË°åÊôÇ„ÅÆ„Ç´„É¨„É≥„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅØ /app „Åß„Åô„ÄÇ
    # Âè∞Êú¨„Éï„Ç©„É´„ÉÄ„ÅØ 'scripts' „ÅÆ‰∏≠„Å´„ÅÇ„Çã„Å®ÊÉ≥ÂÆö„Åó„Åæ„Åô„ÄÇ
    scripts_dir = 'scripts'

    print(f"--- üì• '{scripts_dir}' „Éï„Ç©„É´„ÉÄ„Çí„Çπ„Ç≠„É£„É≥‰∏≠... ---")
    
    # scripts_dir ÂÜÖ„ÅÆ„Åô„Åπ„Å¶„ÅÆ„Ç¢„Ç§„ÉÜ„É†Ôºà„Éï„Ç°„Ç§„É´„ÇÑ„Éï„Ç©„É´„ÉÄÔºâ„ÇíÂèñÂæó
    if not os.path.exists(scripts_dir):
        print(f"üö® „Ç®„É©„Éº: '{scripts_dir}' „Éï„Ç©„É´„ÉÄ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ")
        return

    item_count = 0
    processed_count = 0
    
    for item_name in os.listdir(scripts_dir):
        item_path = os.path.join(scripts_dir, item_name)

        # ‚òÖ‚òÖ‚òÖ „Åì„Åì„ÅåÈáçË¶Å„Å™‰øÆÊ≠£ÁÇπ ‚òÖ‚òÖ‚òÖ
        # „Ç¢„Ç§„ÉÜ„É†„Åå„Éï„Ç©„É´„ÉÄÔºà„Éá„Ç£„É¨„ÇØ„Éà„É™Ôºâ„ÅÆÂ†¥Âêà„ÅÆ„Åø„ÄÅ„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å®„Åó„Å¶Âá¶ÁêÜ„Åô„Çã
        if os.path.isdir(item_path):
            item_count += 1
            try:
                process_project(item_name, scripts_dir)
                processed_count += 1
            except Exception as e:
                print(f"üö®üö®üö® „Éó„É≠„Ç∏„Çß„ÇØ„Éà '{item_name}' „ÅÆÂá¶ÁêÜ‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: {e}")
        else:
            # „Éï„Ç©„É´„ÉÄ„Åß„ÅØ„Å™„ÅÑÂ†¥Âêà„ÅØ„Çπ„Ç≠„ÉÉ„Éó„Åô„Çã
            print(f"‚è≠Ô∏è '{item_name}' „ÅØ„Éï„Ç©„É´„ÉÄ„Åß„ÅØ„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åô„ÄÇ")

    print("\n--------------------------------------------------")
    print("--- ‚úÖ ÂÖ®„Å¶„ÅÆ„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü ---")
    print(f"--- ÁµêÊûú: {processed_count} / {item_count} ‰ª∂ ÊàêÂäü ---")
    print("--------------------------------------------------")


if __name__ == "__main__":
    # "python scripts/main_pipeline.py batch" „ÅÆ„Çà„ÅÜ„Å´ÂÆüË°å„Åï„Çå„ÅüÂ†¥Âêà„ÇíÊÉ≥ÂÆö
    if len(sys.argv) > 1 and sys.argv[1] == 'batch':
        process_batch()
    else:
        print("‰Ωø„ÅÑÊñπ: python scripts/main_pipeline.py batch")
